AWSTemplateFormatVersion: 2010-09-09
Description: |
  Kittens Carousel is a static website application deployed on AWS Simple Storage Service (S3), served through Cloudfront and Route 53 using AWS Cloudformation Service.

Parameters:
  HostedZone:
    Type: AWS::Route53::HostedZone
    Description: The DNS name of an existing Amazon Route 53 hosted zone
    AllowedPattern: (?!-)[a-zA-Z0-9-.]{1,63}(?<!-)
    ConstraintDescription: must be a valid DNS zone name.  
  
  DomainName:
    Type: String
    Description: The full domain name for the web aplication
    AllowedPattern: (?!-)[a-zA-Z0-9-.]{1,63}(?<!-)
    ConstraintDescription: must be a valid domain name. 
  
  
  
  
  
Resources:  
 
  WebServerSimpleRecord:
    Type: "AWS::Route53::RecordSet"
    Properties:
      HostedZoneId: !Ref WebServerHostedZone  
      #MultiValueAnswer: Boolean
      Name: *.hasankaval.com
      TTL: 900 
      Type: A #required
  #myDNSRecord2:
  #Type: AWS::Route53::RecordSet
  #Properties:
  #  HostedZoneName: example.com.
  #  Name: mysite.example.com.
  #  Type: A
  #  TTL: '900'   
  
  CloudFrontDistro:
    Type: "AWS::CloudFront::Distribution"
    Properties:
      DistributionConfig: #required
        Origins:
        - ConnectionAttempts: 3
          ConnectionTimeout: 10
          CustomOriginConfig: 
            #HTTPPort: Integer
            #HTTPSPort: Integer
            OriginKeepaliveTimeout: Integer
            #OriginProtocolPolicy: http-only
            OriginReadTimeout: Integer
            #OriginSSLProtocols: 
            #  - String
          DomainName: hasankaval.com.s3-website-us-east-1.amazonaws.com
          Id: S3-Website-hasankaval.com.s3-website-us-east-1.amazonaws.com
          #OriginCustomHeaders: 
          #  - OriginCustomHeader
        DefaultRootObject: index.html
        Logging:
          IncludeCookies: 'false'
          #Bucket: mylogs.s3.amazonaws.com
          #Prefix: myprefix
        #Aliases: 
        #  - String
        #CacheBehaviors: 
        #  - CacheBehavior
        #Comment: String
        #CustomErrorResponses: 
        #  - CustomErrorResponse
        DefaultCacheBehavior: 
          AllowedMethods: 
            - GET, HEAD
          #CachedMethods: 
          #  - String
          #CachePolicyId: String
          #Compress: Boolean
          #DefaultTTL: Double
          #FieldLevelEncryptionId: String
          #ForwardedValues: 
          #  ForwardedValues
          #LambdaFunctionAssociations: 
          #  - LambdaFunctionAssociation
          #MaxTTL: Double
          #MinTTL: Double
          OriginRequestPolicyId: String
          #RealtimeLogConfigArn: String
          #SmoothStreaming: Boolean
          TargetOriginId: String
          TrustedSigners: 
            - String
          ViewerProtocolPolicy: redirect-to-https
        DefaultRootObject: index.html
        Enabled: 'true' 
        #HttpVersion: String
        IPV6Enabled: 'true'
        Logging: 
          Logging
        OriginGroups: 
          OriginGroups
        PriceClass: PriceClass_All
        Restrictions: 
          Restrictions
        ViewerCertificate: 
          AcmCertificateArn: String
          MinimumProtocolVersion: String
          SslSupportMethod: String
        
  
  KittensCertificate:
    Type: "AWS::CertificateManager::Certificate"
    Properties:
      DomainName: hasankaval.com #required
      DomainValidationOptions:
        - DomainName: hasankaval.com
          HostedZoneId: !Ref WebServerHostedZone
          #ValidationDomain: String
      ValidationMethod: DNS  
  
  WebServerHostedZone:
    Type: "AWS::Route53::HostedZone"
    Properties:
      HostedZoneConfig:
        HostedZoneConfig
      HostedZoneTags:
        - HostedZoneTag
      Name: hasankaval.com #required
      VPCs:
        - VPC
  
Outputs:
  WebsiteURL:
    Value:
      Fn::Join:
        - ""
        - - http://
          - Ref: WebServerSimpleRecord
    Description: The URL of the newly created website